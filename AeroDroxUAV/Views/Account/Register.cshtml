@model AeroDroxUAV.Models.User
@{
    ViewData["Title"] = "Register";
    // Safely retrieve the boolean value
    var isAdmin = ViewBag.IsAdminLoggedIn as bool? ?? false; 
}

<h2>@(isAdmin ? "Create New Admin Account" : "Create Account (User Registration)")</h2>

<form method="post" asp-controller="Account" asp-action="Register">
    <div class="mb-3">
        <label>Username</label>
        <input type="text" name="Username" class="form-control" required />
    </div>
    <div class="mb-3">
        <label>Password</label>
        <input type="password" name="Password" class="form-control" required />
    </div>

    @* Only show the Role selection if an Admin is currently logged in. *@
    @if (isAdmin)
    {
        <div class="mb-3">
            <label>Role</label>
            <select name="Role" class="form-control">
                <option value="User">User</option>
                <option value="Admin">Admin</option>
            </select>
        </div>
    }
    else
    {
        @* Hidden field ensures all public registrations are for "User" role. *@
        <input type="hidden" name="Role" value="User" />
    }

    <button type="submit" class="btn btn-primary">Register</button>
</form>

@if(ViewBag.Error != null)
{
    <div class="alert alert-danger mt-3">
        @ViewBag.Error
    </div>
}